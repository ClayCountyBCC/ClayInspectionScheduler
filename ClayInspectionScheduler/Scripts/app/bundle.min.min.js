var XHR,InspSched;(function(n){var t=function(){function n(n){var i,t,r;for(this.Permit="",i=n.split("&"),t=0;t<i.length;t++){r=i[t].split("=");switch(r[0].toLowerCase()){case"permit":this.Permit=r[1]}}}return n.prototype.update=function(n){var t="";return n.length>0&&(t+="&permit="+n),t.substring(1)},n}();n.LocationHash=t})(InspSched||(InspSched={})),function(n){var t=function(){function n(n,t,i){this.PermitNo=n;this.InspectionCd=t;this.SchecDateTime=i}return n}();n.NewInspection=t}(InspSched||(InspSched={})),function(n){var t;(function(t){"use strict";function p(n){r(document.getElementById("SearchFailed"));i("PermitSelectContainer");i("CurrentPermitData");i("CurrentPermit");i("InspectionTable");i("SearchFailed");i("SuspendedContractor");i("NoInspContainer");i("NotScheduled");u("Searching");var t=n.trim().toUpperCase();return document.getElementById("PermitSearch").setAttribute("value",t),t.length!=8||isNaN(Number(t))?(i("Searching"),y(n),null):t}function w(n,t){n.length==0?y(t):(b(n,t),f(t,n),i("Searching"),document.getElementById("CurrentPermitData").style.display="block",d(t,n))}function b(n,t){var f=document.getElementById("PermitSelect"),h,c,u,l,i;for(r(f),h=e("Search Results","current"),c=e("Related Permits","related"),f.appendChild(h),n.length>1&&f.appendChild(c),u=0,l=n;u<l.length;u++)i=l[u],i.PermitNo==t?(h.appendChild(o(i,t)),s(t,i)):n.length>1&&c.appendChild(o(i,t))}function f(t){var o=document.getElementById("ProjAddrCombined"),s=document.getElementById("ProjCity"),i,f,e;r(o);r(s);i=n.CurrentPermits.filter(function(n){return n.PermitNo===t})[0];i.Supervisor_URL.length>0?(f=document.createElement("a"),f.style.textDecoration="underline",f.href=i.Supervisor_URL,f.appendChild(document.createTextNode(i.ProjAddrCombined.trim())),e=document.createElement("a"),e.style.textDecoration="underline",e.href=i.Supervisor_URL,e.appendChild(document.createTextNode(i.ProjCity.trim())),o.appendChild(f),s.appendChild(e)):(o.appendChild(document.createTextNode(i.ProjAddrCombined.trim())),s.appendChild(document.createTextNode(i.ProjCity.trim())));u("PermitSelectContainer")}function e(n,t){var i=document.createElement("optgroup");return i.label=n,i.value=t,i}function o(n,t){var r=v(n.PermitNo[0]),i=document.createElement("option");return i.setAttribute("value",n.PermitNo.trim()),i.setAttribute("label",n.PermitNo+"  ("+r+")"),i.setAttribute("title",n.PermitNo.trim()),i.appendChild(document.createTextNode(n.PermitNo+"  ("+r+")")),i.id="select_"+n.PermitNo,n.PermitNo==t?(i.value=n.PermitNo.trim(),i.selected=!0):i.value=n.PermitNo.trim(),i}function s(t,u){var f,e,o;document.getElementById("InspectionScheduler").removeAttribute("value");f=document.getElementById("SaveSchedule");f!=undefined&&(f.setAttribute("disabled","disabled"),f.removeAttribute("value"));e=0;o=!0;i("InspSched");i("InspListHeader");i("InspListData");i("NoInspContainer");i("SuspendedContractor");r(document.getElementById("InspListData"));n.transport.GetInspections(t).then(function(i){return i.length>0?(n.CurrentInspections=i,h(n.CurrentInspections,u)):(document.getElementById("NoInspections").style.display="flex",document.getElementById("InspSched").style.display="flex",document.getElementById("PermitScreen").style.display="flex"),l(n.CurrentInspections,t),!0},function(){return console.log("error getting inspections"),!1})}function h(n){var r=document.getElementById("InspListData"),f=document.createElement("tr"),t,i,u;for(console.log("inspections",n),t=0,i=n;t<i.length;t++)u=i[t],r.appendChild(k(u));r.style.removeProperty("display");document.getElementById("InspSched").style.removeProperty("display");document.getElementById("PermitScreen").style.display="flex"}function k(t){var i=document.createElement("div"),r=document.createElement("div"),e=document.createElement("div"),o=document.createElement("div"),s=document.createElement("div"),u=document.createElement("div"),h=document.createElement("div"),l=document.createElement("div"),a=document.createElement("div"),y=document.createElement("div"),p=document.createElement("div"),v,f,w;return r.className="large-10 medium-10 small-12 ",o.className="large-10 medium-10 small-12 ",t.ResultADC==null||t.ResultADC==""?i.className="InspRow large-12 medium-12 small-12 row flex-container align-middle":t.ResultADC=="A"||t.ResultADC=="P"?i.className="InspRow large-12 medium-12 small-12 row flex-container align-middle PassRow":t.ResultADC=="C"?i.className="InspRow large-12 medium-12 small-12 row flex-container align-middle CancelRow":(t.ResultADC=="F"||t.ResultADC=="D"||t.ResultADC=="N")&&(i.className="InspRow large-12 medium-12 small-12 row flex-container align-middle FailRow"),s.className="large-2 medium-6 small-6 column InspPermit ",u.className="large-2 medium-6 small-6 column InspDate",l.className="large-3 medium-6 small-12 InspResult column end",a.className="ButtonContainer large-2 medium-2 small-12 flex-container align-center ",y.className="large-9 medium-6 small-6 inspRemarks column",p.className="large-3 medium-6 small-6 InspResult column end",v=n.CurrentPermits.filter(function(n){return n.PermitNo===t.PermitNo})[0],v.IsExternalUser?s.appendChild(document.createTextNode(t.PermitNo)):(f=document.createElement("a"),f.style.textDecoration="underline",f.href=v.Permit_URL,f.appendChild(document.createTextNode(t.PermitNo)),s.appendChild(f)),t.DisplayInspDateTime.toLowerCase()=="incomplete"?u.appendChild(document.createTextNode(t.DisplaySchedDateTime)):u.appendChild(document.createTextNode(t.DisplayInspDateTime)),h.appendChild(document.createTextNode(t.InsDesc.trim())),y.appendChild(document.createTextNode(t.Remarks!==null&&t.Remarks!==""?"Remarks: "+t.Remarks.trim():"")),p.appendChild(document.createTextNode(t.ResultDescription.trim())),l.appendChild(document.createTextNode(t.InspectorName.trim())),t.ResultADC||t.DisplaySchedDateTime.length===0?(w="CreateNew_"+t.PermitNo,document.getElementById(w)||v.ErrorText.length!==0||a.appendChild(c(w,"New","InspSched.UpdatePermitSelectList('"+t.PermitNo+"');"))):t.ResultADC||(e.style.display="none",nt(t,n.ThisPermit.IsExternalUser)&&a.appendChild(c("","Cancel","InspSched.CancelInspection('"+t.InspReqID+"', '"+t.PermitNo+"');"))),r.appendChild(s),r.appendChild(u),r.appendChild(h),r.appendChild(l),i.appendChild(r),i.appendChild(a),i.appendChild(e),t.DisplayInspDateTime.length>0&&(t.InspReqID!=="99999999"?(h.className="large-5 medium-6 small-6  InspType column",e.className=" large-12 medium-12 small-12 row flex-container",o.appendChild(y),o.appendChild(p),e.appendChild(o)):(l.style.display="none",u.style.display="none",h.className="large-10 medium-6 small-6 InspType InspResult column")),i}function c(n,t,i){var r=document.createElement("button");return r.id=n,r.className="align-self-center columns NewInspButton",r.appendChild(document.createTextNode(t)),r.setAttribute("onclick",i),r}function l(t,i){a(i);n.BuildCalendar(n.ThisPermit.ScheduleDates,n.ThisPermit.ErrorText);document.getElementById("InspectionScheduler").setAttribute("value",i)}function a(t){var o=t[0],a=v(o),s=document.getElementById("InspTypeSelect"),u=document.createElement("option"),c,l,e,h,f,i;for(r(s),u.appendChild(document.createTextNode(a+" Inspections:")),u.className="selectPlaceholder",u.selected,u.value="",s.appendChild(u),c=n.CurrentPermits.filter(function(n){return n.PermitNo===t})[0],l=n.InspectionTypes.filter(function(n){if(n.InspCd[0]===o)return c.NoFinalInspections?!n.Final:!0}),e=0,h=l;e<h.length;e++)f=h[e],f.InspCd[0]==o&&(i=document.createElement("option"),i.label=f.InsDesc,i.value=f.InspCd,i.className="TypeSelectOption",i.appendChild(document.createTextNode(f.InsDesc)),s.appendChild(i))}function v(n){switch(n){case"1":case"0":case"9":return"Building";case"2":return"Electrical";case"3":return"Plumbing";case"4":return"Mechanical";case"6":return"Fire";default:return"Unknown"}}function u(n,t,i){var r;t?(r=document.getElementById(n),t.style.display=i==null?"block":i):(r=document.getElementById(n),r.style.display!=null&&(r.style.display=i==null?"block":i))}function i(n){var t=document.getElementById(n);t&&(t.style.display="none")}function r(n){while(n.firstChild)n.removeChild(n.firstChild)}function d(n,t){var r=document.getElementById("InspectionTable");t&&(i("Searching"),r.style.removeProperty("display"))}function y(n){var f=document.getElementById("SearchFailed"),t;r(f);t=document.createElement("h3");isNaN(Number(n))||n.length!=8?t.innerHTML=!isNaN(Number(n))&&n.length>0&&n.length!=8?'"'+n+'" is not a valid Permit Number':n.length==0?"You did not enter any information.<br />Enter a valid permit number and click search.":"Invalid Entry<br />":t.appendChild(document.createTextNode("Permit #"+n+" not found"));t.style.textAlign="center";f.appendChild(t);i("Searching");u("SearchFailed")}function g(n,t){var f,e,o,u;i("InspectionScheduler");r(document.getElementById("InspTypeSelect"));f=document.getElementById("Reasons");r(f);e=document.getElementById("ErrorHeading");r(e);o=document.createElement("ul");u=document.createElement("li");e.appendChild(document.createTextNode("The following issue is preventing the ability to schedule an inspection:"));u.appendChild(document.createTextNode(t));u.style.marginLeft="2rem;";o.appendChild(u);f.appendChild(o);document.getElementById("NotScheduled").style.display="flex"}function nt(n,t){var i=new Date,r=new Date(n.DisplaySchedDateTime),u=i.getDate()+1;return r<i&&t?!1:!0}t.CurrentPermits=[];t.CurrentInspections=[];t.PermitsWithOutInsp=[];t.Search=p;t.ProcessResults=w;t.UpdatePermitData=f;t.GetInspList=s;t.BuildInspectionList=h;t.BuildScheduler=l;t.LoadInspTypeSelect=a;t.Show=u;t.Hide=i;t.clearElement=r;t.InformUserOfError=g})(t=n.UI||(n.UI={}))}(InspSched||(InspSched={})),function(n){function u(n){var t=new r;return t.Headers=n.getAllResponseHeaders(),t.Text=n.responseText,t.Type=n.responseType,t.Status=n.status,t.StatusText=n.statusText,t}function t(n,t,i,r){return r===void 0&&(r=""),new Promise(function(f,e){var o=new XMLHttpRequest;o.open(n,t);i!=null&&i.forEach(function(n){return o.setRequestHeader(n.header,n.data)});o.onload=function(){(o.status<200||o.status>=300)&&e(u(o));f(u(o))};o.onerror=function(){e("Error "+n.toUpperCase()+'ing data to url "'+t+'", check that it exists and is accessible')};r.length>0?o.send(r):o.send()})}function i(t){return t===null||t.length==0?t=[new n.Header("Content-Type","application/json; charset=utf-8"),new n.Header("Accept","application/json")]:(t.push(new n.Header("Content-Type","application/json; charset=utf-8")),t.push(new n.Header("Accept","application/json"))),t}function f(n,r,u){return r===void 0&&(r=null),u===void 0&&(u=!0),r=u?i(r):r,t("GET",n,r)}function e(n,r,u,f){return r===void 0&&(r=""),u===void 0&&(u=null),f===void 0&&(f=!0),u=f?i(u):u,t("POST",n,u,r)}function o(n,r,u,f){return r===void 0&&(r=""),u===void 0&&(u=null),f===void 0&&(f=!0),u=f?i(u):u,t("PUT",n,u,r)}function s(n,r,u,f){return r===void 0&&(r=""),u===void 0&&(u=null),f===void 0&&(f=!0),u=f?i(u):u,t("DELETE",n,u,r)}var h=function(){function n(n,t){this.header=n;this.data=t}return n}(),r;n.Header=h;r=function(){function n(){}return n}();n.Data=r;n.Get=f;n.Post=e;n.Put=o;n.Delete=s}(XHR||(XHR={})),function(n){var t;(function(t){"use strict";function i(n){var t=XHR.Get("API/Permit/"+n);return new Promise(function(n,i){t.then(function(t){var i=JSON.parse(t.Text);n(i)}).catch(function(){console.log("error in GetPermit");i(null)})})}function r(){var n=XHR.Get("API/InspType/");return new Promise(function(t,i){n.then(function(n){var i=JSON.parse(n.Text);t(i)}).catch(function(){console.log("error in GetInspTypeList");i(null)})})}function u(n){var t=XHR.Get("API/Inspection/"+n);return new Promise(function(n,i){t.then(function(t){var i=JSON.parse(t.Text);n(i)}).catch(function(){console.log("error in GetInspections");i(null)})})}function f(t){var i=XHR.Post("API/NewInspection/",JSON.stringify(t));return new Promise(function(r,u){i.then(function(i){var u=JSON.parse(i.Text);n.UI.GetInspList(t.PermitNo);r(u)}).catch(function(){console.log("error in SaveInspections");n.UI.GetInspList(t.PermitNo);u(null)})})}function e(n,t){var i=XHR.Delete("API/Inspection/"+t+"/"+n);return new Promise(function(n,t){i.then(function(t){var i=JSON.parse(t.Text);n(i)}).catch(function(){console.log("error in GetInspections");t(null)})})}t.GetPermit=i;t.GetInspType=r;t.GetInspections=u;t.SaveInspection=f;t.CancelInspection=e})(t=n.transport||(n.transport={}))}(InspSched||(InspSched={}));
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/jakearchibald/es6-promise/master/LICENSE
 * @version   3.2.2+35df15ea
 */
(function(){"use strict";function dt(n){return"function"==typeof n||"object"==typeof n&&null!==n}function rt(n){return"function"==typeof n}function gt(n){d=n}function ni(n){r=n}function ti(){return function(){process.nextTick(u)}}function ii(){return function(){at(u)}}function ri(){var n=0,i=new bt(u),t=document.createTextNode("");return i.observe(t,{characterData:!0}),function(){t.data=n=++n%2}}function ui(){var n=new MessageChannel;return n.port1.onmessage=u,function(){n.port2.postMessage(0)}}function ut(){return function(){setTimeout(u,1)}}function u(){for(var t,i,n=0;e>n;n+=2)t=o[n],i=o[n+1],t(i),o[n]=void 0,o[n+1]=void 0;e=0}function fi(){try{var t=require,n=t("vertx");return at=n.runOnLoop||n.runOnContext,ii()}catch(i){return ut()}}function ei(n,t){var e=this,i=new this.constructor(f),u,o;return void 0===i[y]&&ht(i),u=e._state,u?(o=arguments[u-1],r(function(){st(u,i,o,e._result)})):w(e,i,n,t),i}function oi(n){var i=this,t;return n&&"object"==typeof n&&n.constructor===i?n:(t=new i(f),c(t,n),t)}function f(){}function si(){return new TypeError("You cannot resolve a promise with itself")}function hi(){return new TypeError("A promises callback cannot return that same promise.")}function ft(n){try{return n.then}catch(t){return p.error=t,p}}function ci(n,t,i,r){try{n.call(t,i,r)}catch(u){return u}}function li(t,u,f){r(function(t){var r=!1,e=ci(f,u,function(n){r||(r=!0,u!==n?c(t,n):i(t,n))},function(i){r||(r=!0,n(t,i))},"Settle: "+(t._label||" unknown promise"));!r&&e&&(r=!0,n(t,e))},t)}function ai(t,r){r._state===a?i(t,r._result):r._state===h?n(t,r._result):w(r,void 0,function(n){c(t,n)},function(i){n(t,i)})}function et(t,r,u){r.constructor===t.constructor&&u===g&&constructor.resolve===nt?ai(t,r):u===p?n(t,p.error):void 0===u?i(t,r):rt(u)?li(t,r,u):i(t,r)}function c(t,r){t===r?n(t,si()):dt(r)?et(t,r,ft(r)):i(t,r)}function vi(n){n._onerror&&n._onerror(n._result);b(n)}function i(n,t){n._state===s&&(n._result=t,n._state=a,0!==n._subscribers.length&&r(b,n))}function n(n,t){n._state===s&&(n._state=h,n._result=t,r(vi,n))}function w(n,t,i,u){var f=n._subscribers,e=f.length;n._onerror=null;f[e]=t;f[e+a]=i;f[e+h]=u;0===e&&n._state&&r(b,n)}function b(n){var i=n._subscribers,e=n._state,r,u,f,t;if(0!==i.length){for(f=n._result,t=0;t<i.length;t+=3)r=i[t],u=i[t+e],r?st(e,r,u,f):u(f);n._subscribers.length=0}}function ot(){this.error=null}function yi(n,t){try{return n(t)}catch(i){return tt.error=i,tt}}function st(t,r,u,f){var e,l,o,v,y=rt(u);if(y){if(e=yi(u,f),e===tt?(v=!0,l=e.error,e=null):o=!0,r===e)return void n(r,hi())}else e=f,o=!0;r._state!==s||(y&&o?c(r,e):v?n(r,l):t===a?i(r,e):t===h&&n(r,e))}function pi(t,i){try{i(function(n){c(t,n)},function(i){n(t,i)})}catch(r){n(t,r)}}function wi(){return kt++}function ht(n){n[y]=kt++;n._state=void 0;n._result=void 0;n._subscribers=[]}function bi(n){return new lt(this,n).promise}function ki(n){var t=this;return new t(yt(n)?function(i,r){for(var f=n.length,u=0;f>u;u++)t.resolve(n[u]).then(i,r)}:function(n,t){t(new TypeError("You must pass an array to race."))})}function di(t){var r=this,i=new r(f);return n(i,t),i}function gi(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");}function nr(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");}function t(n){this[y]=wi();this._result=this._state=void 0;this._subscribers=[];f!==n&&("function"!=typeof n&&gi(),this instanceof t?pi(this,n):nr())}function l(t,r){this._instanceConstructor=t;this.promise=new t(f);this.promise[y]||ht(this.promise);yt(r)?(this._input=r,this.length=r.length,this._remaining=r.length,this._result=new Array(this.length),0===this.length?i(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&i(this.promise,this._result))):n(this.promise,tr())}function tr(){return new Error("Array Methods must be provided an Array")}function ir(){var n,t;if("undefined"!=typeof global)n=global;else if("undefined"!=typeof self)n=self;else try{n=Function("return this")()}catch(i){throw new Error("polyfill failed because global object is unavailable in this environment");}t=n.Promise;(!t||"[object Promise]"!==Object.prototype.toString.call(t.resolve())||t.cast)&&(n.Promise=it)}var ct,lt,k,v;ct=Array.isArray?Array.isArray:function(n){return"[object Array]"===Object.prototype.toString.call(n)};var at,d,vt,yt=ct,e=0,r=function(n,t){o[e]=n;o[e+1]=t;e+=2;2===e&&(d?d(u):vt())},pt="undefined"!=typeof window?window:void 0,wt=pt||{},bt=wt.MutationObserver||wt.WebKitMutationObserver,rr="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),ur="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,o=new Array(1e3);vt=rr?ti():bt?ri():ur?ui():void 0===pt&&"function"==typeof require?fi():ut();var g=ei,nt=oi,y=Math.random().toString(36).substring(16),s=void 0,a=1,h=2,p=new ot,tt=new ot,kt=0,fr=bi,er=ki,or=di,it=t;t.all=fr;t.race=er;t.resolve=nt;t.reject=or;t._setScheduler=gt;t._setAsap=ni;t._asap=r;t.prototype={constructor:t,then:g,"catch":function(n){return this.then(null,n)}};lt=l;l.prototype._enumerate=function(){for(var t=this.length,i=this._input,n=0;this._state===s&&t>n;n++)this._eachEntry(i[n],n)};l.prototype._eachEntry=function(n,t){var i=this._instanceConstructor,e=i.resolve,r,u;e===nt?(r=ft(n),r===g&&n._state!==s?this._settledAt(n._state,t,n._result):"function"!=typeof r?(this._remaining--,this._result[t]=n):i===it?(u=new i(f),et(u,n,r),this._willSettleAt(u,t)):this._willSettleAt(new i(function(t){t(n)}),t)):this._willSettleAt(e(n),t)};l.prototype._settledAt=function(t,r,u){var f=this.promise;f._state===s&&(this._remaining--,t===h?n(f,u):this._result[r]=u);0===this._remaining&&i(f,this._result)};l.prototype._willSettleAt=function(n,t){var i=this;w(n,void 0,function(n){i._settledAt(a,t,n)},function(n){i._settledAt(h,t,n)})};k=ir;v={Promise:it,polyfill:k};"function"==typeof define&&define.amd?define(function(){return v}):"undefined"!=typeof module&&module.exports?module.exports=v:"undefined"!=typeof this&&(this.ES6Promise=v);k()}).call(this),function(n){"use strict";function v(){y();window.onhashchange=o;location.hash.substring(1).length>0&&o()}function c(t){var i=new n.LocationHash(location.hash.substring(1)),r;location.hash=i.update(t);r=new n.LocationHash(location.hash.substring(1));console.log("newhash",r,"oldhash",i);r.Permit===i.Permit&&s()}function o(){var i=location.hash,t=new n.LocationHash(location.hash.substring(1));t.Permit.length>0&&(f.value=t.Permit.trim(),s())}function s(){d.style.display="none";n.UI.Hide("SaveConfirmed");n.UI.Hide("NotScheduled");$("#InspectionSchedulerTabs").foundation("selectTab","InspectionView",!0);var t=f.value.trim();n.transport.GetPermit(n.UI.Search(t)).then(function(i){var f,e,r;for(console.log(i),n.CurrentPermits=i,n.UI.ProcessResults(i,t),f=0,e=i;f<e.length;f++)if(r=e[f],r.PermitNo==t){console.log("our permits match");n.ThisPermit=r;r.ErrorText.length===0?(console.log("build this calendar, yall"),u(r.ScheduleDates)):n.UI.InformUserOfError(r.PermitNo,r.ErrorText);break}return!0},function(){return console.log("error getting permits"),n.UI.Hide("Searching"),!1})}function y(){i.setAttribute("disabled","disabled");r.style.display="none";p()}function p(){n.transport.GetInspType().then(function(t){console.log("inspection types",t);n.InspectionTypes=t},function(){console.log("error in LoadInspectionTypes");n.InspectionTypes=[]})}function u(i,r){if(r===void 0&&(r=""),$(t).datepicker("destroy"),r.length===0){t=$("#sandbox-container div").datepicker({startDate:n.ThisPermit.Dates.minDate_string,datesDisabled:n.ThisPermit.Dates.badDates_string,endDate:n.ThisPermit.Dates.maxDate_string,maxViewMode:0,toggleActive:!0});$(t).on("changeDate",function(){var n=$(t).data("datepicker").getDate();$("change-date").submit();w()});document.getElementById("InspectionScheduler").style.display="flex"}}function w(){h.value!=""&&$(t).data("datepicker").getDate()!=null?i.removeAttribute("disabled"):i.setAttribute("disabled","disabled")}function b(t){var f,r,u,i;for(document.getElementById("NotScheduled").style.display="none",document.getElementById("SaveConfirmed").style.display="none",f=document.getElementById("select_"+t),f.selected=!0,r=0,u=n.CurrentPermits;r<u.length;r++)i=u[r],i.PermitNo==e.value&&(n.ThisPermit=i,n.UI.LoadInspTypeSelect(i.PermitNo),n.UI.BuildScheduler(n.CurrentInspections,i.PermitNo));$("#sandbox-container div").data("datepicker")!=null&&$("#sandbox-container div").data("datepicker")!=undefined&&$("#sandbox-container div").data("datepicker").clearDates();$("#InspectionSchedulerTabs").foundation("selectTab","Scheduler",!0)}function k(t,i){if(document.getElementById("NotScheduled").style.display="none",t!=null&&i!=null){var r=n.transport.CancelInspection(t,i);r&&(n.UI.GetInspList(i),u(n.ThisPermit.ScheduleDates))}}var t=null;n.InspectionTypes=[];n.CurrentPermits=[];n.CurrentInspections=[];n.IssuesExist=[];var d=document.getElementById("PermitScreen"),h=document.getElementById("InspTypeSelect"),tt=document.getElementById("PermitSearchButton"),g=document.getElementById("CloseIssueList"),f=document.getElementById("PermitSearch"),e=document.getElementById("PermitSelect"),nt=document.getElementById("InspectionScheduler"),r=document.getElementById("NotScheduled"),l=document.getElementById("Reasons"),i=document.getElementById("SaveSchedule"),a=document.getElementById("SaveConfirmed");n.start=v;n.updateHash=c;n.HandleHash=o;f.onkeydown=function(n){n.keyCode==13&&c(f.value)};n.SearchPermit=s;e.onchange=function(){var h,o,s,f;for($(t).datepicker("destroy"),r.style.display="none",a.style.display="none",h=n.CurrentPermits,i.setAttribute("disabled","disabled"),o=0,s=h;o<s.length;o++)if(f=s[o],f.PermitNo==e.value){n.ThisPermit=f;f.ErrorText.length>0?n.UI.InformUserOfError(f.PermitNo,f.ErrorText):(n.UI.LoadInspTypeSelect(f.PermitNo),u(f.ScheduleDates));break}};h.onchange=function(){i.setAttribute("value",h.value);$(t).data("datepicker").getDate()!=null&&i.removeAttribute("disabled")};i.onclick=function(){var o;nt.style.display="none";a.style.display="none";r.style.display="none";n.UI.clearElement(l);var u=e.value,s=i.getAttribute("value"),f=document.getElementById("InspTypeSelect"),h=f.options[f.selectedIndex].textContent;n.newInsp=new n.NewInspection(u,s,$(t).data("datepicker").getDate());o=n.transport.SaveInspection(n.newInsp).then(function(t){var f=document.getElementById("ErrorHeading"),e=document.createElement("ul"),o,i,u;if(t.length===0&&t.push("A system error has occurred. Please check your request and try again."),t[0].toLowerCase().indexOf("inspection has been scheduled")===-1){n.UI.clearElement(f);f.appendChild(document.createTextNode("The following issue(s) prevented scheduling the requested inspection:"));for(o in t)i=document.createElement("li"),i.appendChild(document.createTextNode(t[o])),i.style.marginLeft="2rem;",e.appendChild(i);l.appendChild(e);r.style.display="flex"}else u=document.getElementById("SaveSuccess"),n.UI.clearElement(u),u.appendChild(document.createTextNode(t[0])),document.getElementById("SaveConfirmed").style.display="flex";return!0},function(){return console.log("error in Saving Inspection"),!1});n.IssuesExist.length>0&&(r.style.display="flex");n.UI.GetInspList(u)};g.onclick=function(){r.style.display="none"};n.BuildCalendar=u;n.UpdatePermitSelectList=b;n.CancelInspection=k}(InspSched||(InspSched={}));